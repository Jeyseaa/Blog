(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[55],{4026:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blogs",function(){return n(5479)}])},9552:function(e,t,n){"use strict";n.d(t,{J$:function(){return l},Vh:function(){return a},X4:function(){return o},zZ:function(){return r}});var s=n(3921);async function l(e,t){let n=(e-1)*t,l=n+t-1,{data:a,error:r,count:o}=await s.O.from("blogs").select("*",{count:"exact"}).order("created_at",{ascending:!1}).range(n,l);if(r)throw r;return{blogs:a||[],total:o||0}}async function a(e,t,n){let{data:l,error:a}=await s.O.from("blogs").insert([{title:e,content:t,user_id:n}]).select();if(a)throw a;return l[0]}async function r(e,t,n){let{data:l,error:a}=await s.O.from("blogs").update({title:t,content:n}).eq("id",e).select();if(a)throw a;return l[0]}async function o(e){let{error:t}=await s.O.from("blogs").delete().eq("id",e);if(t)throw t}},5479:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var s=n(5893),l=n(7294),a=n(1649),r=n(1163),o=n(9552);function c(){let e=(0,a.v9)(e=>e.auth.user),t=(0,r.useRouter)(),[n,c]=(0,l.useState)(""),[i,d]=(0,l.useState)(""),[u,x]=(0,l.useState)(!1),[b,h]=(0,l.useState)(null),[m,g]=(0,l.useState)([]),[f,p]=(0,l.useState)(1),[y,N]=(0,l.useState)(0),[j,w]=(0,l.useState)(!1);(0,l.useEffect)(()=>{v()},[f]);let v=async()=>{x(!0);try{let{blogs:e,total:t}=await (0,o.J$)(f,5);g(e),N(t)}catch(e){h(e.message)}finally{x(!1)}},C=async()=>{if(!n||!i){h("Title and content are required");return}if(!e){h("You must be logged in to create a blog");return}x(!0),h(null);try{await (0,o.Vh)(n,i,e.id),alert("Blog created successfully"),c(""),d(""),w(!1),v()}catch(e){h(e.message)}finally{x(!1)}},_=async e=>{if(confirm("Are you sure you want to delete this blog?"))try{await (0,o.X4)(e),alert("Blog deleted"),v()}catch(e){alert(e.message)}},k=Math.ceil(y/5);return(0,s.jsxs)("div",{className:"max-w-7xl mx-auto mt-10 p-6 bg-white shadow-md border rounded-md",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Blog Management"}),(0,s.jsx)("button",{className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",onClick:()=>w(!j),children:j?"Cancel":"Create Blog"})]}),j&&(0,s.jsxs)("div",{className:"space-y-4 mb-8 border p-4 rounded-md bg-gray-50",children:[b&&(0,s.jsx)("p",{className:"text-red-600 text-center font-medium",children:b}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium mb-1",children:"Title"}),(0,s.jsx)("input",{type:"text",placeholder:"Enter blog title",value:n,onChange:e=>c(e.target.value),disabled:u,className:"w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium mb-1",children:"Content"}),(0,s.jsx)("textarea",{placeholder:"Write blog content...",value:i,onChange:e=>d(e.target.value),disabled:u,rows:6,className:"w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsx)("button",{onClick:C,disabled:u,className:"px-6 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 font-semibold",children:u?"Creating...":"Submit Blog"})})]}),(0,s.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"All Blogs"}),0===m.length?(0,s.jsx)("p",{className:"text-gray-500",children:"No blogs found."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full table-auto border border-gray-300",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"border px-4 py-2 text-left",children:"ID"}),(0,s.jsx)("th",{className:"border px-4 py-2 text-left",children:"Title"}),(0,s.jsx)("th",{className:"border px-4 py-2 text-left",children:"Content"}),(0,s.jsx)("th",{className:"border px-4 py-2 text-left",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:m.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"border px-4 py-3",children:e.id}),(0,s.jsx)("td",{className:"border px-4 py-3",children:e.title}),(0,s.jsx)("td",{className:"border px-4 py-3",children:e.content.length>100?e.content.slice(0,100)+"...":e.content}),(0,s.jsxs)("td",{className:"border px-4 py-3 space-x-2",children:[(0,s.jsx)("button",{className:"text-blue-600 hover:underline",onClick:()=>t.push("/update-blog?id=".concat(e.id,"&title=").concat(encodeURIComponent(e.title),"&content=").concat(encodeURIComponent(e.content))),children:"Edit"}),(0,s.jsx)("button",{className:"text-red-600 hover:underline",onClick:()=>_(e.id),children:"Delete"})]})]},e.id))})]})}),k>1&&(0,s.jsxs)("div",{className:"flex items-center justify-between mt-6",children:[(0,s.jsx)("button",{onClick:()=>p(Math.max(1,f-1)),disabled:1===f,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded disabled:opacity-50",children:"Prev"}),(0,s.jsxs)("span",{className:"text-gray-700",children:["Page ",f," of ",k]}),(0,s.jsx)("button",{onClick:()=>p(f+1),disabled:f>=k,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded disabled:opacity-50",children:"Next"})]})]})}},1163:function(e,t,n){e.exports=n(6885)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=4026)}),_N_E=e.O()}]);